<h2>Demo Form</h2>
<div class="row">
  <div class="col-md-7">
    <h5>Previous Submissions</h5>
    <table class="table table-bordered table-sm mb-3">
      <thead class="table-light">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Email</th>
          <th>Message</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of pagedEntries(); let i = index">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ entry.name }}</td>
          <td>{{ entry.email }}</td>
          <td>{{ entry.message }}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary me-1" (click)="loadEntry((currentPage - 1) * pageSize + i)">View</button>
            <button class="btn btn-sm btn-outline-danger" (click)="deleteEntry((currentPage - 1) * pageSize + i)">Delete</button>
          </td>
        </tr>
        <tr *ngIf="entries.length === 0">
          <td colspan="5" class="text-muted text-center">No submissions yet.</td>
        </tr>
      </tbody>
    </table>
    <nav *ngIf="totalPages() > 1">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="prevPage()" [disabled]="currentPage === 1">Previous</button>
        </li>
        <li class="page-item" *ngFor="let page of [].constructor(totalPages()); let p = index" [class.active]="currentPage === p + 1">
          <button class="page-link" (click)="goToPage(p + 1)">{{ p + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages()">
          <button class="page-link" (click)="nextPage()" [disabled]="currentPage === totalPages()">Next</button>
        </li>
      </ul>
    </nav>
    <button class="btn btn-success w-100" (click)="createNew()">Create New Form</button>
  </div>
  <div class="col-md-7">
    <form (ngSubmit)="onSubmit()" #demoForm="ngForm" class="mb-3">
      <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <input type="text" id="name" class="form-control" name="name" [(ngModel)]="model.name" [readonly]="readonly" required />
      </div>
      <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" id="email" class="form-control" name="email" [(ngModel)]="model.email" [readonly]="readonly" required email #emailInput="ngModel" />
        <div *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched) && !readonly" class="text-danger small mt-1">
          <span *ngIf="emailInput.errors?.['required']">Email is required.</span>
          <span *ngIf="emailInput.errors?.['email']">Please enter a valid email address.</span>
        </div>
      </div>
      <div class="mb-3">
        <label for="message" class="form-label">Message</label>
        <textarea id="message" class="form-control" name="message" [(ngModel)]="model.message" [readonly]="readonly" rows="3"></textarea>
      </div>
      <div class="d-flex gap-2">
        <button *ngIf="readonly" type="button" class="btn btn-warning" (click)="edit()">Edit</button>
        <button *ngIf="!readonly" type="submit" class="btn btn-primary" [disabled]="!demoForm.valid">{{ editingIndex === null ? 'Submit' : 'Update' }}</button>
        <button *ngIf="editingIndex !== null && !readonly" type="button" class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
      </div>
    </form>
    <div *ngIf="submitted" class="alert alert-success mt-3">
      <strong>Form submitted!</strong>
      <pre>{{ model | json }}</pre>
    </div>
  </div>
</div>
